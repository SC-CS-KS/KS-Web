# CSRF

跨站请求伪造漏洞（Cross-site Request Forgery）。

* 风险等级：高

* 漏洞危害

 攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。
 利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。

* 漏洞验证

```text
* 受害者登录a.com，并保留了登录凭证（Cookie）
* 攻击者引诱受害者访问了b.com
* b.com 向 a.com 发送了一个请求：a.com/act=xx。浏览器会默认携带a.com的Cookie
* a.com接收到请求后，对请求进行验证，并确认是受害者的凭证，误以为是受害者自己发送的请求
* a.com以受害者的名义执行了act=xx
* 攻击完成，攻击者在受害者不知情的情况下，冒充受害者，让a.com执行了自己定义的操作
```

* 修复办法

CSRF漏洞防御主要可以从三个层面进行，即服务端的防御、用户端的防御和安全设备的防御
```text
1.给每个HTTP请求添加一个不可预测的令牌，并保证该令牌对每个用户会话来说是唯一性。
    最好的办法是将独有的令牌包含在隐藏字段中，通过HTTP请求发送，避免在URL中暴露出来。
    
2.设定短暂的可信用户会话时间。
```
